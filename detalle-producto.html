<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="connect-src *; default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net https://fonts.googleapis.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; img-src 'self' data: https:; font-src 'self' data: https://fonts.gstatic.com https://cdnjs.cloudflare.com; frame-src 'self' https://wa.me; child-src 'self' https://wa.me;">
    <title>Detalle del Producto - Mercado Central</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js" defer></script>
</head>
<body class="page-detalle">
    <!-- =============================================================== -->
    <!-- COPIA Y PEGA AQUÍ TU CÓDIGO COMPLETO DEL NAVBAR -->
    <!-- =============================================================== -->
    <nav class="navbar-moderno">
    <div class="logo-container">
      <a href="index.html" class="logo-link">
  <img src="gemini-3-pro-image-preview (nano-banana-pro)_b_quiero_crear_un_logo.png" alt="Logo Mercado Central" class="logo-img">
        <span class="logo-text">Mercado Central</span>
      </a>
    </div>
    
    <!-- NUEVO BLOQUE DE BOTONES MEJORADO -->
    <div class="buttons-nav">
        <!-- Este botón se mostrará solo si el usuario está conectado -->
        <!-- Botones de Panel, Publicar y Logout (solo para usuarios conectados) -->
        <button id="btn-dashboard" class="nav-btn-user nav-icon-btn" style="display: none;" onclick="window.location.href='panel-unificado.html'" title="Mi Panel">
            <i class="fas fa-user"></i>
        </button>
        <button id="btn-publish-logged-in" class="nav-btn-user" style="display: none;" onclick="window.location.href='publicar.html'">
            <i class="fas fa-plus"></i> Publicar anuncio
        </button>
        <button id="btn-logout" class="nav-btn-user" style="display: none;">
            <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
        </button>

        <!-- Botón de Iniciar Sesión (solo para invitados) -->
        <button id="btn-login" class="nav-btn-guest" onclick="window.location.href='login.html'">
            <i class="fas fa-sign-in-alt"></i> Iniciar sesión
        </button>
    </div>
  </nav>

<main class="detalle-page-container">
    <!-- Título y Ubicación (ahora van arriba del todo) -->
    <div class="detalle-header">
        <h1 id="product-name">Cargando Título...</h1>
        <div class="location-info">
            <i class="fas fa-calendar-alt"></i>
            <span id="product-date">Cargando...</span>
        
            <i class="fas fa-map-marker-alt"></i>
            <span id="product-location">Cargando Ubicación...</span>
        </div>
    </div>

    <!-- Contenedor Principal de Grid -->
    <div class="detalle-grid-premium">
        <!-- Columna Izquierda: Galería de Imágenes -->
        <div class="gallery-container-premium">
            <div id="gallery-wrapper">
                <!-- Imagen principal y miniaturas generadas por JS -->
            </div>

            <!-- Descripción justo debajo de la galería -->
            <div class="description-below-gallery">
                <div class="description-container">
                    <h2>Descripción Detallada</h2>
                    <p id="product-description">Cargando descripción...</p>
                </div>
            </div>
        </div>

        <!-- Columna Derecha: Información y Contacto -->
        <div class="info-container-premium">
            <div class="info-box-sticky">
                <div class="price-section">
                    <span class="price-label">Precio</span>
                    <div class="price" id="product-price">$ --.--</div>
                </div>
                <div class="visits-section">
                    <i class="fas fa-eye"></i>
                    <span class="visits-label">Visitas</span>
                    <div class="visits" id="product-visits">0</div>
                </div>
                <div class="contact-seller-box">
                    <h3><i class="fas fa-comments"></i> Contactar al Vendedor</h3>

                    <!-- Botón de reseñas -->
                    <div class="review-seller-section">
                        <p style="font-size: 0.9em; color: #666; margin-bottom: 10px; text-align: center;">
                            <i class="fas fa-info-circle"></i> ¿Hiciste una compra? Ayuda a otros usuarios calificando al vendedor
                        </p>
                        <button id="leave-review-btn" class="btn btn-review-seller" style="display: none; width: 100%; margin-bottom: 15px;">
                            <i class="fas fa-star"></i> Calificar al vendedor
                        </button>
                    </div>

                    <div class="contact-options">
                        <a class="btn btn-whatsapp" id="whatsapp-link" style="display: none; margin-bottom: 10px; text-decoration: none; cursor: pointer;">
                            <i class="fab fa-whatsapp"></i> WhatsApp
                        </a>
                        <a class="btn btn-email" id="email-link" style="display: none; margin-bottom: 10px; text-decoration: none; cursor: pointer;">
                            <i class="fas fa-envelope"></i> Email
                        </a>
                        <a class="btn btn-phone" id="phone-link" style="display: none; text-decoration: none; cursor: pointer;">
                            <i class="fas fa-phone-alt"></i> Teléfono
                        </a>
                    </div>
                    <div class="contact-form-section">
                        <h4>O envía un mensaje directo</h4>
                        <form id="contact-form">
                            <textarea name="message" placeholder="Hola, estoy interesado en este anuncio y me gustaría tener más detalles."></textarea>
                            <button type="submit" class="btn">Enviar Mensaje</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- Sección de Opiniones sobre el Vendedor -->
<section class="seller-reviews-section" id="seller-reviews-section" style="display: none;">
    <div class="container">
        <h2><i class="fas fa-star"></i> Opiniones sobre el vendedor</h2>
        <div id="seller-reviews-stats" class="reviews-stats"></div>
        <div id="seller-reviews-list" class="reviews-list"></div>
    </div>
</section>

    <!-- =============================================================== -->
    <!-- FOOTER PREMIUM -->
    <!-- =============================================================== -->
    <footer class="footer">
    <div class="footer-contenedor">
      <div class="footer-col">
        <h4 class="footer-title">Mercado Central</h4>
        <p>Tu plataforma confiable para comprar, vender y encontrar lo que necesites en tu ciudad.</p>
      </div>
      <div class="footer-col">
        <h4 class="footer-title">Enlaces rápidos</h4>
        <ul>
          <li><a href="#">Quiénes somos</a></li>
          <li><a href="#">Términos y Condiciones</a></li>
          <li><a href="#">Política de Privacidad</a></li>
          <li><a href="#">Contáctanos</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <h4 class="footer-title">Síguenos</h4>
        <div class="social-links">
                    <a href="#"><i class="fab fa-facebook-f"></i> Facebook</a>
                    <a href="#"><i class="fab fa-instagram"></i> Instagram</a>
                    <a href="#"><i class="fab fa-twitter"></i> Twitter/X</a>
        </div>
      </div>
      <div class="footer-col">
        <h4 class="footer-title">App y Pagos</h4>
        <p class="footer-subtitle">Próximamente</p>
        <div class="app-buttons">
            <span class="store-badge-placeholder"><i class="fab fa-google-play"></i> Google Play</span>
            <span class="store-badge-placeholder"><i class="fab fa-apple"></i> App Store</span>
        </div>
        <h4 class="footer-title" style="margin-top: 15px;">Pagos Seguros</h4>
        <div class="payment-icons">
            <i class="fab fa-cc-visa"></i>
            <i class="fab fa-cc-mastercard"></i>
            <i class="fab fa-cc-paypal"></i>
        </div>
      </div>
    </div>
    <div class="footer-bottom">
      <p>© 2024 Mercado Central - Todos los derechos reservados</p>
    </div>
  </footer>

    <!-- Carga la librería de Supabase PRIMERO -->
    <script type="module" src="supabase-client.js" defer></script>

    <!-- Inicialización centralizada -->
    <script type="module" src="main.js" defer></script>

    <!-- Carga la lógica específica de detalle del producto -->
    <script type="module" src="product-detail-logic.js" defer></script>
</body>
</html>
