<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Panel - Mercado Central</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="form.css">
    <link rel="stylesheet" href="panel-unificado.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body id="panel-unificado-page">
    <!-- NAVBAR -->
    <nav class="navbar-moderno">
        <div class="logo-container">
            <a href="index.html" class="logo-link">
                <img src="imgx-logopng.jpeg" alt="Logo Mercado Central" class="logo-img">
                <span class="logo-text">Mercado Central</span>
            </a>
        </div>
        
        <div class="buttons-nav">
            <button id="btn-publish-logged-in" class="nav-btn-user" onclick="window.location.href='publicar.html'">
                <i class="fas fa-plus"></i> Publicar anuncio
            </button>
            <button id="btn-logout" class="nav-btn-user">
                <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
            </button>
        </div>
    </nav>

    <!-- CONTENEDOR PRINCIPAL UNIFICADO -->
    <main class="panel-unificado-container">
        <!-- TARJETA DE PERFIL SUPERIOR -->
        <section class="profile-header-card">
            <div class="profile-header-content">
                <div class="profile-header-left">
                    <div class="profile-photo-wrapper">
                        <img id="profile-photo-header" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23fff'%3E%3Cpath d='M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z'/%3E%3C/svg%3E" alt="Foto de Perfil" class="profile-photo-header">
                        <button type="button" id="upload-photo-btn" class="upload-photo-btn-header" title="Cambiar foto de perfil">
                            <i class="fas fa-camera"></i>
                        </button>
                    </div>
                    <input type="file" id="profile-photo-input" accept="image/*" style="display: none;">
                </div>

                <div class="profile-header-info">
                    <h1 id="header-full-name">Mi Panel</h1>
                    <p id="header-business-name" class="business-name-header">-</p>
                    <div class="header-contact-info">
                        <span id="header-email"><i class="fas fa-envelope"></i> <span id="email-value">Cargando...</span></span>
                        <span id="header-phone"><i class="fas fa-phone"></i> <span id="phone-value">-</span></span>
                        <span id="header-whatsapp"><i class="fab fa-whatsapp"></i> <span id="whatsapp-value">-</span></span>
                    </div>
                </div>

                <div class="profile-header-stats">
                    <div class="stat-item">
                        <span class="stat-number" id="total-ads">0</span>
                        <span class="stat-label">Anuncios</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="active-ads">0</span>
                        <span class="stat-label">Activos</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="sold-ads">0</span>
                        <span class="stat-label">Vendidos</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- TABS DE NAVEGACIÓN -->
        <div class="panel-tabs">
            <button class="tab-btn active" data-tab="anuncios">
                <i class="fas fa-list"></i> Mis Anuncios
            </button>
            <button class="tab-btn" data-tab="perfil">
                <i class="fas fa-user"></i> Mi Perfil
            </button>
        </div>

        <!-- CONTENIDO DE ANUNCIOS -->
        <section class="tab-content active" id="anuncios-tab">
            <div class="anuncios-header">
                <h2>Mis Anuncios</h2>
                <div class="filter-buttons">
                    <button class="filter-btn active" data-filter="todos">Todos</button>
                    <button class="filter-btn" data-filter="activos">Activos</button>
                    <button class="filter-btn" data-filter="vendidos">Vendidos</button>
                </div>
            </div>
            <div id="my-ads-container" class="anuncios-grid">
                <p class="loading-message">Cargando tus anuncios...</p>
            </div>
        </section>

        <!-- CONTENIDO DE PERFIL -->
        <section class="tab-content" id="perfil-tab">
            <div class="perfil-content">
                <h2>Editar Mi Perfil</h2>

                <!-- FORMULARIO DE DATOS DEL PERFIL -->
                <form id="profile-form" class="profile-form-unified">
                    <div class="form-section">
                        <h3>Información Personal</h3>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="full-name">Nombre Completo</label>
                                <input type="text" id="full-name" name="full_name" placeholder="Tu nombre completo" required>
                                <span class="char-count"><span id="full-name-count">0</span>/100</span>
                            </div>

                            <div class="form-group">
                                <label for="email">Email</label>
                                <input type="email" id="email" name="email" placeholder="Tu email" disabled>
                                <small class="help-text">No se puede cambiar desde aquí</small>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="phone">Teléfono</label>
                                <input type="tel" id="phone" name="phone" placeholder="Ej: +507 1234-5678">
                                <span class="char-count"><span id="phone-count">0</span>/20</span>
                            </div>

                            <div class="form-group">
                                <label for="whatsapp">WhatsApp</label>
                                <input type="tel" id="whatsapp" name="whatsapp" placeholder="Ej: +507 1234-5678">
                                <span class="char-count"><span id="whatsapp-count">0</span>/20</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3>Información de Negocio</h3>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="business-name">Nombre del Negocio / Marca</label>
                                <input type="text" id="business-name" name="business_name" placeholder="Ej: Mi Tienda Online">
                                <span class="char-count"><span id="business-name-count">0</span>/100</span>
                            </div>

                            <div class="form-group">
                                <label for="business-type">Tipo de Negocio</label>
                                <select id="business-type" name="business_type">
                                    <option value="">Selecciona</option>
                                    <option value="persona-natural">Persona Natural</option>
                                    <option value="tienda">Tienda</option>
                                    <option value="negocio">Negocio</option>
                                    <option value="empresa">Empresa</option>
                                    <option value="otro">Otro</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-row single">
                            <div class="form-group">
                                <label for="description">Descripción / Bio</label>
                                <textarea id="description" name="description" placeholder="Cuéntanos sobre tu negocio o marca..." rows="4"></textarea>
                                <span class="char-count"><span id="description-count">0</span>/500</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3>Ubicación</h3>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="location-province">Provincia</label>
                                <select id="location-province" name="provincia">
                                    <option value="">Selecciona provincia</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="location-district">Distrito</label>
                                <select id="location-district" name="distrito">
                                    <option value="">Selecciona distrito</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="location-address">Dirección</label>
                            <input type="text" id="location-address" name="direccion" placeholder="Tu dirección completa">
                            <span class="char-count"><span id="location-address-count">0</span>/150</span>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" id="save-profile-btn" class="btn-primary">
                            <i class="fas fa-save"></i> Guardar Cambios
                        </button>
                    </div>
                </form>
            </div>
        </section>
    </main>

    <!-- FOOTER -->
    <footer class="footer">
        <div class="footer-contenedor">
            <div class="footer-col">
                <h4>Mercado Central</h4>
                <p>Tu plataforma confiable para comprar, vender y encontrar lo que necesites.</p>
            </div>
            <div class="footer-col">
                <h4>Enlaces rápidos</h4>
                <ul>
                    <li><a href="#">Quiénes somos</a></li>
                    <li><a href="#">Términos y Condiciones</a></li>
                    <li><a href="#">Política de Privacidad</a></li>
                    <li><a href="#">Contáctanos</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h4>Síguenos</h4>
                <div class="social-links">
                    <a href="#" target="_blank"><i class="fab fa-facebook-f"></i> Facebook</a>
                    <a href="#" target="_blank"><i class="fab fa-instagram"></i> Instagram</a>
                    <a href="#" target="_blank"><i class="fab fa-twitter"></i> Twitter</a>
                    <a href="#" target="_blank"><i class="fab fa-youtube"></i> YouTube</a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>© 2024 Mercado Central - Todos los derechos reservados</p>
        </div>
    </footer>

    <script src="supabase-client.js"></script>
    <script type="module" src="panel-unificado-logic.js"></script>
</body>
</html>
