<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demo Sistema de Rese√±as - Mercado Central</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- NAVBAR -->
    <nav class="navbar-moderno">
        <div class="logo-container">
            <a href="index.html" class="logo-link">
                <img src="gemini-3-pro-image-preview (nano-banana-pro)_b_quiero_crear_un_logo.png" alt="Mercado Central" class="logo-img">
                <span class="logo-text">Mercado Central</span>
            </a>
        </div>
        <div class="buttons-nav">
            <button id="btn-login" class="nav-btn-guest" onclick="window.location.href='login.html'">
                <i class="fas fa-sign-in-alt"></i> Iniciar sesi√≥n
            </button>
        </div>
    </nav>

    <!-- CONTENIDO PRINCIPAL -->
    <main style="padding: 8rem 5% 4rem;">
        <div class="container">
            <h1 style="text-align: center; margin-bottom: 4rem;">Demo: Sistema de Rese√±as</h1>

            <!-- EJEMPLO 1: ESTRELLAS INTERACTIVAS -->
            <section style="margin-bottom: 4rem;">
                <h2>1. Componente de Estrellas Interactivas</h2>
                <p>Prueba hacer clic en las estrellas:</p>
                <div id="interactive-stars-demo" style="margin: 2rem 0;"></div>
                <p id="rating-result" style="margin-top: 1rem; font-weight: bold;"></p>
            </section>

            <!-- EJEMPLO 2: ESTAD√çSTICAS DE RESE√ëAS -->
            <section style="margin-bottom: 4rem;">
                <h2>2. Estad√≠sticas de Rese√±as</h2>
                <p>As√≠ se ver√≠an las estad√≠sticas de un vendedor:</p>
                <div id="stats-demo" style="margin: 2rem 0;"></div>
            </section>

            <!-- EJEMPLO 3: LISTA DE RESE√ëAS -->
            <section style="margin-bottom: 4rem;">
                <h2>3. Lista de Rese√±as</h2>
                <p>Rese√±as de ejemplo:</p>
                <div id="reviews-list-demo" style="margin: 2rem 0;"></div>
            </section>

            <!-- EJEMPLO 4: BOT√ìN PARA ABRIR MODAL -->
            <section style="margin-bottom: 4rem;">
                <h2>4. Modal para Crear Rese√±as</h2>
                <p>Haz clic en el bot√≥n para abrir el modal de rese√±as:</p>
                <button id="open-review-modal" class="btn-primary" style="margin: 2rem 0; padding: 1rem 2rem; font-size: 1.2rem;">
                    <i class="fas fa-star"></i> Dejar una rese√±a
                </button>
            </section>

            <!-- EJEMPLO 5: INTEGRACI√ìN EN TARJETAS -->
            <section style="margin-bottom: 4rem;">
                <h2>5. Integraci√≥n en Tarjetas de Anuncios</h2>
                <p>As√≠ se ver√≠an las rese√±as en las tarjetas de productos:</p>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; margin: 2rem 0;">
                    <!-- Tarjeta de ejemplo 1 -->
                    <div class="box" style="margin: 0;">
                        <div class="image-container">
                            <div class="swiper product-swiper">
                                <div class="swiper-wrapper">
                                    <div class="swiper-slide">
                                        <img src="https://images.unsplash.com/photo-1560518883-ce09059eeffa?w=400&h=300&fit=crop" alt="Producto">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="content">
                            <div class="price">$1,500</div>
                            <h3>Casa Moderna</h3>
                            <div class="location"><i class="fas fa-map-marker-alt"></i> Ciudad de Panam√°</div>
                            <div class="seller-rating" style="margin: 1rem 0; padding: 0.5rem; background: #f8f9fa; border-radius: 8px; text-align: center;">
                                <div style="font-size: 1.4em; font-weight: bold; color: #2c3e50;">4.5</div>
                                <div style="font-size: 0.9em; color: #666;">12 rese√±as</div>
                            </div>
                            <a href="#" class="btn-contact">Contactar</a>
                        </div>
                    </div>

                    <!-- Tarjeta de ejemplo 2 -->
                    <div class="box" style="margin: 0;">
                        <div class="image-container">
                            <div class="swiper product-swiper">
                                <div class="swiper-wrapper">
                                    <div class="swiper-slide">
                                        <img src="https://images.unsplash.com/photo-1492144534655-ae79c964c9d7?w=400&h=300&fit=crop" alt="Producto">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="content">
                            <div class="price">$25,000</div>
                            <h3>Auto Deportivo</h3>
                            <div class="location"><i class="fas fa-map-marker-alt"></i> Col√≥n</div>
                            <div class="seller-rating" style="margin: 1rem 0; padding: 0.5rem; background: #f8f9fa; border-radius: 8px; text-align: center;">
                                <div style="font-size: 1.4em; font-weight: bold; color: #2c3e50;">Nuevo vendedor</div>
                                <div style="font-size: 0.9em; color: #666;">Sin rese√±as a√∫n</div>
                            </div>
                            <a href="#" class="btn-contact">Contactar</a>
                        </div>
                    </div>
                </div>
            </section>

            <!-- INSTRUCCIONES DE USO -->
            <section style="background: #f8f9fa; padding: 3rem; border-radius: 12px; margin-bottom: 4rem;">
                <h2>üìö C√≥mo Integrar el Sistema de Rese√±as</h2>

                <h3>1. Importar el m√≥dulo:</h3>
                <pre style="background: #fff; padding: 1rem; border-radius: 8px; overflow-x: auto;"><code>import {
    StarRating,
    ReviewModal,
    getSellerReviews,
    getSellerReviewStats,
    generateReviewStatsHTML,
    generateReviewHTML
} from './reviews-logic.js';</code></pre>

                <h3>2. Mostrar estad√≠sticas en perfil:</h3>
                <pre style="background: #fff; padding: 1rem; border-radius: 8px; overflow-x: auto;"><code>const stats = await getSellerReviewStats(sellerId);
const statsHtml = generateReviewStatsHTML(stats);
document.getElementById('reviews-section').innerHTML = statsHtml;</code></pre>

                <h3>3. Mostrar lista de rese√±as:</h3>
                <pre style="background: #fff; padding: 1rem; border-radius: 8px; overflow-x: auto;"><code>const reviews = await getSellerReviews(sellerId);
const reviewsHtml = reviews.map(review => generateReviewHTML(review)).join('');
document.getElementById('reviews-list').innerHTML = reviewsHtml;</code></pre>

                <h3>4. Abrir modal para nueva rese√±a:</h3>
                <pre style="background: #fff; padding: 1rem; border-radius: 8px; overflow-x: auto;"><code>const modal = new ReviewModal(sellerId, sellerName, (newReview) => {
    // Callback cuando se crea una rese√±a
    console.log('Nueva rese√±a creada:', newReview);
    // Recargar rese√±as...
});
modal.show();</code></pre>
            </section>
        </div>
    </main>

    <!-- Scripts -->
    <script type="module">
        import { supabase } from './supabase-client.js';
        import {
            StarRating,
            ReviewModal,
            generateReviewStatsHTML,
            generateReviewHTML,
            showNotification
        } from './reviews-logic.js';

        // Inicializar cuando el DOM est√© listo
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üöÄ Inicializando demo de rese√±as...');

            // 1. Estrellas interactivas
            const starsContainer = document.getElementById('interactive-stars-demo');
            const ratingResult = document.getElementById('rating-result');

            const starRating = new StarRating(starsContainer, {
                onRatingChange: (rating) => {
                    ratingResult.textContent = `Calificaci√≥n seleccionada: ${rating} estrella${rating !== 1 ? 's' : ''}`;
                }
            });

            // 2. Estad√≠sticas de ejemplo
            const mockStats = {
                total_reviews: 24,
                average_rating: 4.2,
                rating_5_stars: 12,
                rating_4_stars: 8,
                rating_3_stars: 3,
                rating_2_stars: 1,
                rating_1_star: 0
            };

            const statsHtml = generateReviewStatsHTML(mockStats);
            document.getElementById('stats-demo').innerHTML = statsHtml;

            // 3. Lista de rese√±as de ejemplo
            const mockReviews = [
                {
                    id: 1,
                    rating: 5,
                    comment: 'Excelente vendedor, muy recomendado. El producto lleg√≥ en perfectas condiciones y antes de lo esperado.',
                    created_at: '2024-01-20T10:30:00Z',
                    reviewer: {
                        nombre_negocio: 'Comprador Satisfecho',
                        url_foto_perfil: null
                    }
                },
                {
                    id: 2,
                    rating: 4,
                    comment: 'Buen vendedor, respondi√≥ r√°pido a mis preguntas. El producto es tal como se describe.',
                    created_at: '2024-01-18T15:45:00Z',
                    reviewer: {
                        nombre_negocio: 'Cliente Frecuente',
                        url_foto_perfil: null
                    }
                },
                {
                    id: 3,
                    rating: 5,
                    comment: '¬°Incre√≠ble experiencia! El vendedor fue muy amable y profesional.',
                    created_at: '2024-01-15T09:20:00Z',
                    reviewer: {
                        nombre_negocio: 'Usuario Premium',
                        url_foto_perfil: null
                    }
                }
            ];

            const reviewsHtml = mockReviews.map(review => generateReviewHTML(review)).join('');
            document.getElementById('reviews-list-demo').innerHTML = `
                <div class="reviews-list">${reviewsHtml}</div>
            `;

            // 4. Modal de rese√±as
            document.getElementById('open-review-modal').addEventListener('click', () => {
                // Nota: Para que funcione completamente necesitas estar logueado
                // y tener un sellerId real
                const modal = new ReviewModal(
                    'seller-uuid-demo', // En producci√≥n: ID real del vendedor
                    'Vendedor Demo',
                    (newReview) => {
                        console.log('Rese√±a creada:', newReview);
                        showNotification('¬°Rese√±a enviada exitosamente!', 'success');
                    }
                );
                modal.show();
            });

            console.log('‚úÖ Demo de rese√±as inicializado');
        });
    </script>
</body>
</html>